<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Print Service Order Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
        }
        .windows-shadow {
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .windows-button {
            background-color: #e1e1e1;
            border: 1px solid #adadad;
            transition: all 0.2s;
        }
        .windows-button:hover {
            background-color: #e5f1fb;
            border-color: #0078d7;
        }
        .windows-button.primary {
            background-color: #0078d7;
            border-color: #006cc1;
            color: white;
        }
        .windows-button.primary:hover {
            background-color: #106ebe;
        }
        .windows-input {
            border: 1px solid #adadad;
            padding: 5px 8px;
        }
        .windows-input:focus {
            border-color: #0078d7;
            outline: none;
        }
        .windows-select {
            border: 1px solid #adadad;
            padding: 5px 8px;
            background-color: white;
        }
        .status-pending {
            background-color: #fff4ce;
            color: #805600;
        }
        .status-in-progress {
            background-color: #deecf9;
            color: #0078d7;
        }
        .status-completed {
            background-color: #dff6dd;
            color: #107c10;
        }
        .tab-active {
            border-bottom: 2px solid #0078d7;
            color: #0078d7;
        }
        .login-container {
            background: linear-gradient(135deg, #0078d7, #106ebe);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .login-box {
            background-color: white;
            border-radius: 4px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            width: 100%;
            max-width: 400px;
            padding: 2rem;
        }
        .login-logo {
            text-align: center;
            margin-bottom: 1.5rem;
        }
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background-color: #dff6dd;
            border-left: 4px solid #107c10;
            color: #107c10;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s ease;
        }
        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }
        .windows-titlebar {
            background: linear-gradient(to right, #0078d7, #106ebe);
        }
        
        /* Responsive styles */
        @media (max-width: 768px) {
            .sidebar-mobile {
                position: fixed;
                left: -100%;
                top: 0;
                height: 100%;
                width: 80%;
                z-index: 50;
                transition: left 0.3s ease;
            }
            
            .sidebar-mobile.open {
                left: 0;
            }
            
            .mobile-menu-overlay {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: rgba(0, 0, 0, 0.5);
                z-index: 40;
                display: none;
            }
            
            .mobile-menu-overlay.open {
                display: block;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .table-responsive {
                display: block;
                width: 100%;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            .mobile-action-buttons {
                display: flex;
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .mobile-action-buttons button {
                width: 100%;
                justify-content: center;
            }
        }
        
        /* Print styles */
        @media print {
            body * {
                visibility: hidden;
            }
            #print-content, #print-content * {
                visibility: visible;
            }
            #print-content {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            .no-print {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="login-screen" class="login-container">
        <div class="login-box">
            <div class="login-logo">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto text-blue-600" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M5 4v3H4a2 2 0 00-2 2v3a2 2 0 002 2h1v2a1 1 0 001 1h10a1 1 0 001-1v-2h1a2 2 0 002-2v-3a2 2 0 00-2-2h-1V4a1 1 0 00-1-1H6a1 1 0 00-1 1zm2 3V5h8v2H7zm8 8H7v-2h8v2zm2-4H5v-3h12v3z" clip-rule="evenodd" />
                </svg>
                <h1 class="text-2xl font-bold mt-2">Print Service Order Management</h1>
                <p class="text-gray-500">Eurojapan Motors Limited</p>
            </div>
            
            <div id="login-error" class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4 hidden">
                <p>Invalid username or password. Please try again.</p>
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">Username</label>
                <input type="text" id="username" class="windows-input w-full rounded" placeholder="Enter your username" value="admin">
            </div>
            
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                <input type="password" id="password" class="windows-input w-full rounded" placeholder="Enter your password" value="admin">
            </div>
            
            <button id="login-btn" class="windows-button primary w-full py-2 rounded">Log In</button>
            
            <div class="mt-4 text-center text-sm text-gray-500">
                <p>Default account: admin / admin</p>
                <p>Alternative: user / password</p>
            </div>
        </div>
    </div>

    <!-- Main App (hidden by default) -->
    <div id="main-app" class="min-h-screen flex flex-col hidden">
        <!-- Mobile menu overlay -->
        <div id="mobile-menu-overlay" class="mobile-menu-overlay"></div>
        
        <!-- Windows-style title bar -->
        <div class="windows-titlebar flex justify-between items-center px-4 py-2 text-white">
            <div class="flex items-center">
                <button id="mobile-menu-btn" class="md:hidden mr-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd" />
                    </svg>
                </button>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M5 4v3H4a2 2 0 00-2 2v3a2 2 0 002 2h1v2a1 1 0 001 1h10a1 1 0 001-1v-2h1a2 2 0 002-2v-3a2 2 0 00-2-2h-1V4a1 1 0 00-1-1H6a1 1 0 00-1 1zm2 3V5h8v2H7zm8 8H7v-2h8v2zm2-4H5v-3h12v3z" clip-rule="evenodd" />
                </svg>
                <span class="font-semibold">Print Service Order Management</span>
            </div>
        </div>

        <!-- Main content -->
        <div class="flex flex-1">
            <!-- Sidebar -->
            <div id="sidebar" class="w-64 bg-gray-100 border-r border-gray-300 md:block sidebar-mobile">
                <div class="p-4">
                    <div class="flex items-center mb-6">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-600 mr-2" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M5 4v3H4a2 2 0 00-2 2v3a2 2 0 002 2h1v2a1 1 0 001 1h10a1 1 0 001-1v-2h1a2 2 0 002-2v-3a2 2 0 00-2-2h-1V4a1 1 0 00-1-1H6a1 1 0 00-1 1zm2 3V5h8v2H7zm8 8H7v-2h8v2zm2-4H5v-3h12v3z" clip-rule="evenodd" />
                        </svg>
                        <span class="font-bold text-lg">Print Services</span>
                    </div>
                    
                    <div class="space-y-1">
                        <button id="dashboard-btn" class="windows-button w-full text-left px-4 py-2 rounded flex items-center tab-active">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" />
                            </svg>
                            Dashboard
                        </button>
                        <button id="new-order-btn" class="windows-button w-full text-left px-4 py-2 rounded flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
                            </svg>
                            New Order
                        </button>
                        <button id="orders-btn" class="windows-button w-full text-left px-4 py-2 rounded flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" />
                            </svg>
                            All Orders
                        </button>
                        <button id="users-btn" class="windows-button w-full text-left px-4 py-2 rounded flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z" />
                            </svg>
                            Users
                        </button>
                    </div>
                </div>
                
                <div class="border-t border-gray-300 p-4">
                    <div class="text-sm text-gray-600">Logged in as</div>
                    <div class="font-semibold" id="user-name">Admin User</div>
                    <button id="logout-btn" class="windows-button mt-2 px-3 py-1 text-sm rounded">Log Out</button>
                </div>
            </div>

            <!-- Main content area -->
            <div class="flex-1 flex flex-col">
                <!-- Dashboard View -->
                <div id="dashboard-view" class="flex-1 p-6">
                    <div class="flex justify-between items-center mb-6 flex-wrap">
                        <h1 class="text-2xl font-semibold mb-2 md:mb-0">Dashboard</h1>
                        <div class="flex space-x-2 flex-wrap">
                            <button class="windows-button primary px-4 py-2 rounded flex items-center mb-2 md:mb-0" id="dashboard-new-order-btn">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
                                </svg>
                                New Order
                            </button>
                            <button class="windows-button px-4 py-2 rounded flex items-center mb-2 md:mb-0" id="export-dashboard-btn">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" />
                                </svg>
                                Export PDF
                            </button>
                        </div>
                    </div>

                    <!-- Stats Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6 stats-grid">
                        <div class="bg-white p-6 rounded windows-shadow">
                            <div class="text-sm text-gray-500 mb-1">Pending Orders</div>
                            <div class="text-3xl font-bold" id="pending-count">12</div>
                            <div class="text-sm text-orange-500 mt-2">+3 since yesterday</div>
                        </div>
                        <div class="bg-white p-6 rounded windows-shadow">
                            <div class="text-sm text-gray-500 mb-1">In Progress</div>
                            <div class="text-3xl font-bold" id="in-progress-count">8</div>
                            <div class="text-sm text-blue-500 mt-2">-2 since yesterday</div>
                        </div>
                        <div class="bg-white p-6 rounded windows-shadow">
                            <div class="text-sm text-gray-500 mb-1">Completed Today</div>
                            <div class="text-3xl font-bold" id="completed-count">5</div>
                            <div class="text-sm text-green-500 mt-2">+1 since yesterday</div>
                        </div>
                    </div>

                    <!-- Recent Orders -->
                    <div class="bg-white rounded windows-shadow mb-6">
                        <div class="border-b border-gray-200 px-6 py-4 flex justify-between items-center">
                            <h2 class="font-semibold">Recent Orders</h2>
                            <button id="view-all-orders" class="text-blue-600 text-sm">View All</button>
                        </div>
                        <div class="overflow-x-auto table-responsive">
                            <table class="w-full" id="recent-orders">
                                <thead>
                                    <tr class="bg-gray-50">
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Control #</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Customer</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total</th>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="recent-orders-table" class="bg-white divide-y divide-gray-200">
                                    <!-- Recent orders will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- New Order Form (hidden by default) -->
                <div id="new-order-view" class="flex-1 p-6 hidden">
                    <div class="flex justify-between items-center mb-6 flex-wrap">
                        <h1 class="text-2xl font-semibold mb-2 md:mb-0">New Print Service Order</h1>
                        <div class="flex space-x-2 flex-wrap">
                            <button id="save-order-btn" class="windows-button primary px-4 py-2 rounded mb-2 md:mb-0">Save Order</button>
                            <button id="export-new-order-btn" class="windows-button px-4 py-2 rounded flex items-center mb-2 md:mb-0">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" />
                                </svg>
                                Export PDF
                            </button>
                        </div>
                    </div>

                    <div class="bg-white rounded windows-shadow p-6" id="new-order-form">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Customer Name</label>
                                <input type="text" id="customer-name" class="windows-input w-full rounded" placeholder="Enter customer name">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Date</label>
                                <input type="date" id="order-date" class="windows-input w-full rounded" value="">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Control #</label>
                                <input type="text" id="control-number" class="windows-input w-full rounded bg-gray-100" value="" readonly>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Phone</label>
                                <input type="tel" id="customer-phone" class="windows-input w-full rounded" placeholder="Enter phone number">
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Address</label>
                                <input type="text" id="customer-address" class="windows-input w-full rounded" placeholder="Enter address">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Term of Service</label>
                                <select id="term-of-service" class="windows-select w-full rounded">
                                    <option>Standard (3-5 days)</option>
                                    <option>Express (1-2 days)</option>
                                    <option>Same Day</option>
                                </select>
                            </div>
                        </div>

                        <div class="mb-6">
                            <h3 class="font-semibold mb-3">Order Description</h3>
                            <div class="overflow-x-auto table-responsive">
                                <table class="w-full">
                                    <thead>
                                        <tr class="bg-gray-50">
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Qty</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Size</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Additional Instructions</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Price</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="order-items">
                                        <tr>
                                            <td class="px-4 py-2">
                                                <input type="number" class="windows-input w-16 item-qty" value="1">
                                            </td>
                                            <td class="px-4 py-2">
                                                <select class="windows-select w-full item-desc">
                                                    <option>BANNERS</option>
                                                    <option>SIGN</option>
                                                    <option>TSHIRT PRINTING</option>
                                                    <option>VINYL STICKERS</option>
                                                    <option>NUMBER PLATES</option>
                                                    <option>NUMBER BOAT</option>
                                                    <option>BILLBOARDS</option>
                                                    <option>LABELS</option>
                                                </select>
                                            </td>
                                            <td class="px-4 py-2">
                                                <input type="text" class="windows-input w-full item-size" placeholder="Size">
                                            </td>
                                            <td class="px-4 py-2">
                                                <input type="text" class="windows-input w-full item-instructions" placeholder="Instructions">
                                            </td>
                                            <td class="px-4 py-2">
                                                <input type="number" class="windows-input w-24 item-price" placeholder="0.00" step="0.01">
                                            </td>
                                            <td class="px-4 py-2">
                                                <button class="windows-button px-2 py-1 text-sm remove-item-btn">Remove</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <button id="add-item-btn" class="windows-button mt-3 px-3 py-1 text-sm rounded flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
                                </svg>
                                Add Item
                            </button>
                        </div>

                        <div class="flex justify-between items-start flex-wrap">
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Job Status</label>
                                <select id="job-status" class="windows-select rounded">
                                    <option>Pending</option>
                                    <option>In Progress</option>
                                    <option>Completed</option>
                                </select>
                            </div>
                            <div class="text-right">
                                <div class="text-sm text-gray-500 mb-1">Subtotal</div>
                                <div id="subtotal" class="text-lg font-semibold">$0.00</div>
                                <div class="text-sm text-gray-500 mt-2 mb-1">Tax (10%)</div>
                                <div id="tax" class="text-lg font-semibold">$0.00</div>
                                <div class="text-sm text-gray-500 mt-2 mb-1">Total</div>
                                <div id="total" class="text-xl font-bold">$0.00</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- All Orders View (hidden by default) -->
                <div id="orders-view" class="flex-1 p-6 hidden">
                    <div class="flex justify-between items-center mb-6 flex-wrap">
                        <h1 class="text-2xl font-semibold mb-2 md:mb-0">All Orders</h1>
                        <div class="flex space-x-2 w-full md:w-auto justify-between md:justify-start flex-wrap">
                            <div class="relative mb-2 md:mb-0 w-full md:w-auto">
                                <input type="text" id="search-orders" class="windows-input pl-8 pr-4 py-2 rounded w-full" placeholder="Search orders...">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400 absolute left-2 top-2.5" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                                </svg>
                            </div>
                            <button class="windows-button px-4 py-2 rounded flex items-center mb-2 md:mb-0">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M3 3a1 1 0 011-1h12a1 1 0 011 1v3a1 1 0 01-.293.707L12 11.414V15a1 1 0 01-.293.707l-2 2A1 1 0 018 17v-5.586L3.293 6.707A1 1 0 013 6V3z" clip-rule="evenodd" />
                                </svg>
                                Filter
                            </button>
                            <button id="export-all-orders-btn" class="windows-button px-4 py-2 rounded flex items-center mb-2 md:mb-0">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" />
                                </svg>
                                Export PDF
                            </button>
                        </div>
                    </div>

                    <div class="bg-white rounded windows-shadow" id="all-orders-container">
                        <div class="overflow-x-auto table-responsive">
                            <table class="w-full" id="all-orders">
                                <thead>
                                    <tr class="bg-gray-50">
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Control #</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Customer</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total</th>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="all-orders-table" class="bg-white divide-y divide-gray-200">
                                    <!-- All orders will be populated here -->
                                </tbody>
                            </table>
                        </div>
                        <div class="px-6 py-3 flex items-center justify-between border-t border-gray-200 flex-wrap">
                            <div class="text-sm text-gray-500 mb-2 md:mb-0">
                                Showing <span class="font-medium">1</span> to <span class="font-medium" id="showing-orders">5</span> of <span class="font-medium" id="total-orders">5</span> results
                            </div>
                            <div class="flex space-x-1">
                                <button class="windows-button px-3 py-1 text-sm rounded">Previous</button>
                                <button class="windows-button primary px-3 py-1 text-sm rounded">1</button>
                                <button class="windows-button px-3 py-1 text-sm rounded">2</button>
                                <button class="windows-button px-3 py-1 text-sm rounded">3</button>
                                <button class="windows-button px-3 py-1 text-sm rounded">Next</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Users View (hidden by default) -->
                <div id="users-view" class="flex-1 p-6 hidden">
                    <div class="flex justify-between items-center mb-6 flex-wrap">
                        <h1 class="text-2xl font-semibold mb-2 md:mb-0">User Management</h1>
                        <div class="flex space-x-2">
                            <button id="add-user-btn" class="windows-button primary px-4 py-2 rounded flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
                                </svg>
                                Add User
                            </button>
                            <button id="export-users-btn" class="windows-button px-4 py-2 rounded flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" />
                                </svg>
                                Export PDF
                            </button>
                        </div>
                    </div>

                    <div class="bg-white rounded windows-shadow" id="users-container">
                        <div class="overflow-x-auto table-responsive">
                            <table class="w-full" id="users-table">
                                <thead>
                                    <tr class="bg-gray-50">
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Username</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Full Name</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Role</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Last Login</th>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="users-table-body" class="bg-white divide-y divide-gray-200">
                                    <!-- Users will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Order Details Modal (hidden by default) -->
    <div id="order-details-modal" class="fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded windows-shadow w-full max-w-4xl max-h-[90vh] overflow-y-auto m-4">
            <div class="windows-titlebar flex justify-between items-center px-4 py-2 text-white">
                <div class="font-semibold">Order Details</div>
                <button id="close-modal-btn" class="px-3 py-1 hover:bg-red-500">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="p-6" id="print-content">
                <div class="flex justify-between items-start mb-6 flex-wrap">
                    <div class="mb-4 md:mb-0">
                        <h2 class="text-2xl font-semibold" id="modal-order-number">#PS-2023-0145</h2>
                        <p class="text-gray-500" id="modal-customer-name">Acme Corporation</p>
                    </div>
                    <div class="text-right">
                        <div id="modal-status" class="px-3 py-1 inline-flex text-sm font-semibold rounded-full status-in-progress">In Progress</div>
                        <p class="text-gray-500 mt-1" id="modal-order-date">June 15, 2023</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <h3 class="font-semibold mb-2">Customer Information</h3>
                        <div class="bg-gray-50 p-4 rounded">
                            <p><span class="font-medium">Phone:</span> <span id="modal-phone">(555) 123-4567</span></p>
                            <p><span class="font-medium">Address:</span> <span id="modal-address">123 Business Ave, Suite 101, Business City, BC 12345</span></p>
                            <p><span class="font-medium">Term of Service:</span> <span id="modal-term">Standard (3-5 days)</span></p>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-semibold mb-2">Order Summary</h3>
                        <div class="bg-gray-50 p-4 rounded">
                            <p><span class="font-semibold">Items:</span> <span id="modal-items-count">2</span></p>
                            <p><span class="font-semibold">Subtotal:</span> <span id="modal-subtotal">$222.73</span></p>
                            <p><span class="font-semibold">Tax (10%):</span> <span id="modal-tax">$22.27</span></p>
                            <p class="font-bold mt-2">Total: <span id="modal-total">$245.00</span></p>
                        </div>
                    </div>
                </div>

                <h3 class="font-semibold mb-3">Order Items</h3>
                <div class="overflow-x-auto mb-6 table-responsive">
                    <table class="w-full">
                        <thead>
                            <tr class="bg-gray-50">
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Qty</th>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Size</th>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Additional Instructions</th>
                                <th class="px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Price</th>
                            </tr>
                        </thead>
                        <tbody id="modal-items">
                            <!-- Order items will be populated here -->
                        </tbody>
                    </table>
                </div>

                <div class="flex justify-between flex-wrap">
                    <div class="mb-4 md:mb-0">
                        <h3 class="font-semibold mb-2">Order History</h3>
                        <div class="bg-gray-50 p-4 rounded max-w-md">
                            <div id="modal-history">
                                <!-- Order history will be populated here -->
                            </div>
                        </div>
                    </div>
                    <div class="text-right no-print">
                        <h3 class="font-semibold mb-2">Actions</h3>
                        <div class="space-y-2 mobile-action-buttons">
                            <button id="update-status-btn" class="windows-button primary w-40 px-4 py-2 rounded">Update Status</button>
                            <button id="print-order-btn" class="windows-button w-40 px-4 py-2 rounded flex items-center justify-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M5 4v3H4a2 2 0 00-2 2v3a2 2 0 002 2h1v2a1 1 0 001 1h10a1 1 0 001-1v-2h1a2 2 0 002-2v-3a2 2 0 00-2-2h-1V4a1 1 0 00-1-1H6a1 1 0 00-1 1zm2 3V5h8v2H7zm8 8H7v-2h8v2zm2-4H5v-3h12v3z" clip-rule="evenodd" />
                                </svg>
                                Print Order
                            </button>
                            <button id="export-order-btn" class="windows-button w-40 px-4 py-2 rounded flex items-center justify-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" />
                                </svg>
                                Export PDF
                            </button>
                            <button id="edit-order-btn" class="windows-button w-40 px-4 py-2 rounded">Edit Order</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit User Modal (hidden by default) -->
    <div id="user-modal" class="fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded windows-shadow w-full max-w-md m-4">
            <div class="windows-titlebar flex justify-between items-center px-4 py-2 text-white">
                <div class="font-semibold" id="user-modal-title">Add New User</div>
                <button id="close-user-modal-btn" class="px-3 py-1 hover:bg-red-500">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="p-6">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Username</label>
                    <input type="text" id="user-username" class="windows-input w-full rounded" placeholder="Enter username">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
                    <input type="text" id="user-fullname" class="windows-input w-full rounded" placeholder="Enter full name">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                    <input type="password" id="user-password" class="windows-input w-full rounded" placeholder="Enter password">
                </div>
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Role</label>
                    <select id="user-role" class="windows-select w-full rounded">
                        <option value="Administrator">Administrator</option>
                        <option value="User">User</option>
                    </select>
                </div>
                <div class="flex justify-end space-x-2">
                    <button id="cancel-user-btn" class="windows-button px-4 py-2 rounded">Cancel</button>
                    <button id="save-user-btn" class="windows-button primary px-4 py-2 rounded">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Update Status Modal (hidden by default) -->
    <div id="status-modal" class="fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded windows-shadow w-full max-w-md m-4">
            <div class="windows-titlebar flex justify-between items-center px-4 py-2 text-white">
                <div class="font-semibold">Update Order Status</div>
                <button id="close-status-modal-btn" class="px-3 py-1 hover:bg-red-500">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="p-6">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Order Number</label>
                    <input type="text" id="status-order-number" class="windows-input w-full rounded bg-gray-100" readonly>
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Current Status</label>
                    <input type="text" id="status-current" class="windows-input w-full rounded bg-gray-100" readonly>
                </div>
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-1">New Status</label>
                    <select id="status-new" class="windows-select w-full rounded">
                        <option>Pending</option>
                        <option>In Progress</option>
                        <option>Completed</option>
                    </select>
                </div>
                <div class="flex justify-end space-x-2">
                    <button id="cancel-status-btn" class="windows-button px-4 py-2 rounded">Cancel</button>
                    <button id="save-status-btn" class="windows-button primary px-4 py-2 rounded">Update Status</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
        <div class="flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
            </svg>
            <span id="notification-message">Login successful!</span>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize jsPDF
            const { jsPDF } = window.jspdf;
            
            // Initialize data
            let orders = [
                {
                    controlNumber: "#PS-2023-0145",
                    customer: "Acme Corporation",
                    date: "2023-06-15",
                    description: "2 Banners, 50 Vinyl Stickers",
                    status: "In Progress",
                    total: "$245.00",
                    phone: "(555) 123-4567",
                    address: "123 Business Ave, Suite 101, Business City, BC 12345",
                    term: "Standard (3-5 days)",
                    items: [
                        { qty: 2, desc: "BANNERS", size: "3ft x 6ft", instructions: "Full color, grommets every 2 feet", price: "$150.00" },
                        { qty: 50, desc: "VINYL STICKERS", size: "3\" x 3\"", instructions: "Weather resistant, glossy finish", price: "$72.73" }
                    ],
                    subtotal: "$222.73",
                    tax: "$22.27",
                    history: [
                        { date: "June 15, 2023 - 10:30 AM", action: "Order status changed to In Progress", by: "Print Shop Department" },
                        { date: "June 14, 2023 - 2:15 PM", action: "Order created", by: "Reception" }
                    ]
                },
                {
                    controlNumber: "#PS-2023-0144",
                    customer: "City Events",
                    date: "2023-06-14",
                    description: "1 Billboard, 10 T-shirts",
                    status: "Pending",
                    total: "$780.00",
                    phone: "(555) 234-5678",
                    address: "456 Event Plaza, Downtown, EC 54321",
                    term: "Express (1-2 days)",
                    items: [
                        { qty: 1, desc: "BILLBOARDS", size: "10ft x 20ft", instructions: "High resolution print", price: "$500.00" },
                        { qty: 10, desc: "TSHIRT PRINTING", size: "Mixed sizes", instructions: "Full color front and back", price: "$209.09" }
                    ],
                    subtotal: "$709.09",
                    tax: "$70.91",
                    history: [
                        { date: "June 14, 2023 - 9:45 AM", action: "Order created", by: "Reception" }
                    ]
                },
                {
                    controlNumber: "#PS-2023-0143",
                    customer: "Local Restaurant",
                    date: "2023-06-13",
                    description: "200 Labels, 5 Signs",
                    status: "Completed",
                    total: "$320.00",
                    phone: "(555) 345-6789",
                    address: "789 Food St, Cuisine City, FC 67890",
                    term: "Standard (3-5 days)",
                    items: [
                        { qty: 200, desc: "LABELS", size: "2\" x 3\"", instructions: "Waterproof, food-safe", price: "$180.00" },
                        { qty: 5, desc: "SIGN", size: "18\" x 24\"", instructions: "Double-sided, with stands", price: "$110.91" }
                    ],
                    subtotal: "$290.91",
                    tax: "$29.09",
                    history: [
                        { date: "June 15, 2023 - 3:20 PM", action: "Order status changed to Completed", by: "Print Shop Department" },
                        { date: "June 14, 2023 - 11:15 AM", action: "Order status changed to In Progress", by: "Print Shop Department" },
                        { date: "June 13, 2023 - 1:30 PM", action: "Order created", by: "Reception" }
                    ]
                }
            ];
            
            // User accounts
            let users = [
                { username: "admin", password: "admin", name: "Admin User", role: "Administrator", lastLogin: "2023-06-15 08:30 AM" },
                { username: "user", password: "password", name: "Regular User", role: "User", lastLogin: "2023-06-14 02:15 PM" }
            ];
            
            // Current logged in user
            let currentUser = null;
            
            // Current order being viewed/edited
            let currentOrder = null;
            
            // Set today's date in the order form
            const today = new Date();
            const formattedDate = today.toISOString().split('T')[0];
            document.getElementById('order-date').value = formattedDate;
            
            // Generate next control number
            function generateControlNumber() {
                const year = today.getFullYear();
                const lastOrder = orders[0];
                const lastOrderNum = parseInt(lastOrder.controlNumber.split('-')[2]);
                const newOrderNum = (lastOrderNum + 1).toString().padStart(4, '0');
                return `#PS-${year}-${newOrderNum}`;
            }
            
            document.getElementById('control-number').value = generateControlNumber();
            
            // Update order counts
            function updateOrderCounts() {
                const pendingCount = orders.filter(order => order.status === 'Pending').length;
                const inProgressCount = orders.filter(order => order.status === 'In Progress').length;
                const completedToday = orders.filter(order => {
                    return order.status === 'Completed' && new Date(order.date).toDateString() === today.toDateString();
                }).length;
                
                document.getElementById('pending-count').textContent = pendingCount;
                document.getElementById('in-progress-count').textContent = inProgressCount;
                document.getElementById('completed-count').textContent = completedToday;
                document.getElementById('total-orders').textContent = orders.length;
                document.getElementById('showing-orders').textContent = Math.min(orders.length, 5);
            }
            
            // Populate recent orders table
            function populateRecentOrders() {
                const recentOrdersTable = document.getElementById('recent-orders-table');
                recentOrdersTable.innerHTML = '';
                
                // Get the 3 most recent orders
                const recentOrders = orders.slice(0, 3);
                
                recentOrders.forEach(order => {
                    const row = document.createElement('tr');
                    
                    const statusClass = order.status === 'Pending' ? 'status-pending' : 
                                      order.status === 'In Progress' ? 'status-in-progress' : 
                                      'status-completed';
                    
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">${order.controlNumber}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm">${order.customer}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm">${order.date}</td>
                        <td class="px-6 py-4 text-sm">${order.description}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusClass}">${order.status}</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm">${order.total}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                            <button class="text-blue-600 hover:text-blue-900 view-order-btn">View</button>
                        </td>
                    `;
                    
                    recentOrdersTable.appendChild(row);
                });
                
                // Add event listeners to view buttons
                document.querySelectorAll('#recent-orders-table .view-order-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const row = this.closest('tr');
                        const controlNumber = row.cells[0].textContent;
                        showOrderDetails(controlNumber);
                    });
                });
            }
            
            // Populate all orders table
            function populateAllOrders() {
                const allOrdersTable = document.getElementById('all-orders-table');
                allOrdersTable.innerHTML = '';
                
                orders.forEach(order => {
                    const row = document.createElement('tr');
                    
                    const statusClass = order.status === 'Pending' ? 'status-pending' : 
                                      order.status === 'In Progress' ? 'status-in-progress' : 
                                      'status-completed';
                    
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">${order.controlNumber}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm">${order.customer}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm">${order.date}</td>
                        <td class="px-6 py-4 text-sm">${order.description}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusClass}">${order.status}</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm">${order.total}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                            <button class="text-blue-600 hover:text-blue-900 mr-3 edit-order-btn">Edit</button>
                            <button class="text-blue-600 hover:text-blue-900 view-order-btn">View</button>
                        </td>
                    `;
                    
                    allOrdersTable.appendChild(row);
                });
                
                // Add event listeners to view buttons
                document.querySelectorAll('#all-orders-table .view-order-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const row = this.closest('tr');
                        const controlNumber = row.cells[0].textContent;
                        showOrderDetails(controlNumber);
                    });
                });
                
                // Add event listeners to edit buttons
                document.querySelectorAll('#all-orders-table .edit-order-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const row = this.closest('tr');
                        const controlNumber = row.cells[0].textContent;
                        editOrder(controlNumber);
                    });
                });
            }
            
            // Populate users table
            function populateUsers() {
                const usersTableBody = document.getElementById('users-table-body');
                usersTableBody.innerHTML = '';
                
                users.forEach(user => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">${user.username}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm">${user.name}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm">${user.role}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm">${user.lastLogin || 'Never'}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                            <button class="text-blue-600 hover:text-blue-900 mr-3 edit-user-btn">Edit</button>
                            <button class="text-red-600 hover:text-red-900 delete-user-btn">Delete</button>
                        </td>
                    `;
                    usersTableBody.appendChild(row);
                });
                
                // Add event listeners to edit buttons
                document.querySelectorAll('#users-table-body .edit-user-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const row = this.closest('tr');
                        const username = row.cells[0].textContent;
                        editUser(username);
                    });
                });
                
                // Add event listeners to delete buttons
                document.querySelectorAll('#users-table-body .delete-user-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const row = this.closest('tr');
                        const username = row.cells[0].textContent;
                        deleteUser(username);
                    });
                });
            }
            
            // Initialize tables
            updateOrderCounts();
            populateRecentOrders();
            populateAllOrders();
            populateUsers();
            
            // Login functionality
            document.getElementById('login-btn').addEventListener('click', function() {
                login();
            });

            // Add keypress event listener for Enter key on login form
            document.getElementById('password').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    login();
                }
            });

            // Login function
            function login() {
                const username = document.getElementById('username').value.trim();
                const password = document.getElementById('password').value.trim();
                
                // Find user
                const user = users.find(u => u.username === username && u.password === password);
                
                if (user) {
                    // Login successful
                    currentUser = user;
                    
                    // Update last login time
                    const now = new Date();
                    user.lastLogin = now.toLocaleDateString('en-US') + ' ' + now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
                    
                    // Update UI with user info
                    document.getElementById('user-name').textContent = currentUser.name;
                    
                    // Hide login screen, show main app
                    document.getElementById('login-screen').classList.add('hidden');
                    document.getElementById('main-app').classList.remove('hidden');
                    
                    // Show notification
                    showNotification(`Welcome, ${currentUser.name}!`);
                    
                    // Hide login error if it was shown
                    document.getElementById('login-error').classList.add('hidden');
                    
                    // Update users table
                    populateUsers();
                } else {
                    // Login failed
                    document.getElementById('login-error').classList.remove('hidden');
                }
            }
            
            // Logout functionality
            document.getElementById('logout-btn').addEventListener('click', function() {
                // Clear current user
                currentUser = null;
                
                // Clear login form
                document.getElementById('username').value = 'admin';
                document.getElementById('password').value = 'admin';
                document.getElementById('login-error').classList.add('hidden');
                
                // Show login screen, hide main app
                document.getElementById('login-screen').classList.remove('hidden');
                document.getElementById('main-app').classList.add('hidden');
                
                showNotification('Logged out successfully!');
            });
            
            // Tab navigation
            const dashboardBtn = document.getElementById('dashboard-btn');
            const newOrderBtn = document.getElementById('new-order-btn');
            const ordersBtn = document.getElementById('orders-btn');
            const usersBtn = document.getElementById('users-btn');
            
            const dashboardView = document.getElementById('dashboard-view');
            const newOrderView = document.getElementById('new-order-view');
            const ordersView = document.getElementById('orders-view');
            const usersView = document.getElementById('users-view');
            
            // Function to show a view and hide others
            function showView(viewToShow) {
                [dashboardView, newOrderView, ordersView, usersView].forEach(view => {
                    view.classList.add('hidden');
                });
                viewToShow.classList.remove('hidden');
                
                // Update active tab
                [dashboardBtn, newOrderBtn, ordersBtn, usersBtn].forEach(btn => {
                    btn.classList.remove('tab-active');
                });
            }
            
            // Tab click handlers
            dashboardBtn.addEventListener('click', () => {
                showView(dashboardView);
                dashboardBtn.classList.add('tab-active');
            });
            
            newOrderBtn.addEventListener('click', () => {
                showView(newOrderView);
                newOrderBtn.classList.add('tab-active');
            });
            
            ordersBtn.addEventListener('click', () => {
                showView(ordersView);
                ordersBtn.classList.add('tab-active');
            });
            
            usersBtn.addEventListener('click', () => {
                showView(usersView);
                usersBtn.classList.add('tab-active');
            });
            
            // Mobile menu button
            document.getElementById('mobile-menu-btn').addEventListener('click', () => {
                document.getElementById('sidebar').classList.add('open');
                document.getElementById('mobile-menu-overlay').classList.add('open');
            });
            
            document.getElementById('mobile-menu-overlay').addEventListener('click', () => {
                document.getElementById('sidebar').classList.remove('open');
                document.getElementById('mobile-menu-overlay').classList.remove('open');
            });
            
            // New Order button on dashboard
            document.getElementById('dashboard-new-order-btn').addEventListener('click', () => {
                showView(newOrderView);
                newOrderBtn.classList.add('tab-active');
            });
            
            // View All Orders button
            document.getElementById('view-all-orders').addEventListener('click', () => {
                showView(ordersView);
                ordersBtn.classList.add('tab-active');
            });
            
            // Add item button
            document.getElementById('add-item-btn').addEventListener('click', () => {
                const orderItems = document.getElementById('order-items');
                const newRow = document.createElement('tr');
                newRow.innerHTML = `
                    <td class="px-4 py-2">
                        <input type="number" class="windows-input w-16 item-qty" value="1">
                    </td>
                    <td class="px-4 py-2">
                        <select class="windows-select w-full item-desc">
                            <option>BANNERS</option>
                            <option>SIGN</option>
                            <option>TSHIRT PRINTING</option>
                            <option>VINYL STICKERS</option>
                            <option>NUMBER PLATES</option>
                            <option>NUMBER BOAT</option>
                            <option>BILLBOARDS</option>
                            <option>LABELS</option>
                        </select>
                    </td>
                    <td class="px-4 py-2">
                        <input type="text" class="windows-input w-full item-size" placeholder="Size">
                    </td>
                    <td class="px-4 py-2">
                        <input type="text" class="windows-input w-full item-instructions" placeholder="Instructions">
                    </td>
                    <td class="px-4 py-2">
                        <input type="number" class="windows-input w-24 item-price" placeholder="0.00" step="0.01">
                    </td>
                    <td class="px-4 py-2">
                        <button class="windows-button px-2 py-1 text-sm remove-item-btn">Remove</button>
                    </td>
                `;
                orderItems.appendChild(newRow);
                
                // Add event listener to the remove button
                const removeBtn = newRow.querySelector('.remove-item-btn');
                removeBtn.addEventListener('click', function() {
                    orderItems.removeChild(newRow);
                    calculateTotal();
                });
                
                // Add event listener to price input
                const priceInput = newRow.querySelector('.item-price');
                priceInput.addEventListener('input', calculateTotal);
                
                // Add event listeners to quantity input
                const qtyInput = newRow.querySelector('.item-qty');
                qtyInput.addEventListener('input', calculateTotal);
            });
            
            // Calculate total
            function calculateTotal() {
                const rows = document.querySelectorAll('#order-items tr');
                let subtotal = 0;
                
                rows.forEach(row => {
                    const qty = parseInt(row.querySelector('.item-qty').value) || 0;
                    const price = parseFloat(row.querySelector('.item-price').value) || 0;
                    subtotal += qty * price;
                });
                
                const tax = subtotal * 0.1;
                const total = subtotal + tax;
                
                document.getElementById('subtotal').textContent = `$${subtotal.toFixed(2)}`;
                document.getElementById('tax').textContent = `$${tax.toFixed(2)}`;
                document.getElementById('total').textContent = `$${total.toFixed(2)}`;
            }
            
            // Initialize price calculation for existing items
            document.querySelectorAll('.item-price, .item-qty').forEach(input => {
                input.addEventListener('input', calculateTotal);
            });
            
            // Add event listeners to remove buttons in the initial row
            document.querySelectorAll('.remove-item-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const row = this.closest('tr');
                    if (document.querySelectorAll('#order-items tr').length > 1) {
                        row.remove();
                        calculateTotal();
                    }
                });
            });
            
            // Show notification
            function showNotification(message) {
                const notification = document.getElementById('notification');
                document.getElementById('notification-message').textContent = message;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
            
            // Save order button
            document.getElementById('save-order-btn').addEventListener('click', () => {
                // Get form values
                const customerName = document.getElementById('customer-name').value;
                const orderDate = document.getElementById('order-date').value;
                const controlNumber = document.getElementById('control-number').value;
                const phone = document.getElementById('customer-phone').value;
                const address = document.getElementById('customer-address').value;
                const term = document.getElementById('term-of-service').value;
                const status = document.getElementById('job-status').value;
                
                // Validate required fields
                if (!customerName) {
                    showNotification('Please enter customer name');
                    return;
                }
                
                // Get order items
                const itemRows = document.querySelectorAll('#order-items tr');
                const items = [];
                let description = '';
                
                itemRows.forEach(row => {
                    const qty = row.querySelector('.item-qty').value;
                    const desc = row.querySelector('.item-desc').value;
                    const size = row.querySelector('.item-size').value;
                    const instructions = row.querySelector('.item-instructions').value;
                    const price = row.querySelector('.item-price').value;
                    
                    if (qty && desc) {
                        items.push({
                            qty: parseInt(qty),
                            desc: desc,
                            size: size,
                            instructions: instructions,
                            price: `$${parseFloat(price || 0).toFixed(2)}`
                        });
                        
                        // Build description for the order list
                        if (description) description += ', ';
                        description += `${qty} ${desc}`;
                    }
                });
                
                if (items.length === 0) {
                    showNotification('Please add at least one item');
                    return;
                }
                
                // Get totals
                const subtotal = document.getElementById('subtotal').textContent;
                const tax = document.getElementById('tax').textContent;
                const total = document.getElementById('total').textContent;
                
                // Create history entry
                const now = new Date();
                const formattedDateTime = `${now.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })} - ${now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true })}`;
                
                // Create new order object
                const newOrder = {
                    controlNumber: controlNumber,
                    customer: customerName,
                    date: orderDate,
                    description: description,
                    status: status,
                    total: total,
                    phone: phone,
                    address: address,
                    term: term,
                    items: items,
                    subtotal: subtotal,
                    tax: tax,
                    history: [
                        { date: formattedDateTime, action: "Order created", by: currentUser ? currentUser.name : "System" }
                    ]
                };
                
                // Check if we're editing an existing order
                const existingOrderIndex = orders.findIndex(o => o.controlNumber === controlNumber);
                
                if (existingOrderIndex !== -1) {
                    // Update existing order
                    orders[existingOrderIndex] = newOrder;
                    showNotification('Order updated successfully!');
                } else {
                    // Add to orders array
                    orders.unshift(newOrder);
                    showNotification('Order saved successfully!');
                }
                
                // Update tables
                updateOrderCounts();
                populateRecentOrders();
                populateAllOrders();
                
                // Reset form for next order
                document.getElementById('customer-name').value = '';
                document.getElementById('customer-phone').value = '';
                document.getElementById('customer-address').value = '';
                document.getElementById('term-of-service').selectedIndex = 0;
                document.getElementById('job-status').selectedIndex = 0;
                
                // Clear order items except the first row
                const orderItems = document.getElementById('order-items');
                while (orderItems.children.length > 1) {
                    orderItems.removeChild(orderItems.lastChild);
                }
                
                // Reset first row
                const firstRow = orderItems.firstChild;
                firstRow.querySelector('.item-qty').value = '1';
                firstRow.querySelector('.item-desc').selectedIndex = 0;
                firstRow.querySelector('.item-size').value = '';
                firstRow.querySelector('.item-instructions').value = '';
                firstRow.querySelector('.item-price').value = '';
                
                // Reset totals
                document.getElementById('subtotal').textContent = '$0.00';
                document.getElementById('tax').textContent = '$0.00';
                document.getElementById('total').textContent = '$0.00';
                
                // Generate new control number
                document.getElementById('control-number').value = generateControlNumber();
                
                // Go back to dashboard
                showView(dashboardView);
                dashboardBtn.classList.add('tab-active');
            });
            
            // Show order details
            function showOrderDetails(controlNumber) {
                const order = orders.find(o => o.controlNumber === controlNumber);
                
                if (order) {
                    // Store current order
                    currentOrder = order;
                    
                    // Fill modal with order details
                    document.getElementById('modal-order-number').textContent = order.controlNumber;
                    document.getElementById('modal-customer-name').textContent = order.customer;
                    document.getElementById('modal-order-date').textContent = formatDate(order.date);
                    document.getElementById('modal-phone').textContent = order.phone;
                    document.getElementById('modal-address').textContent = order.address;
                    document.getElementById('modal-term').textContent = order.term;
                    document.getElementById('modal-items-count').textContent = order.items.length;
                    document.getElementById('modal-subtotal').textContent = order.subtotal;
                    document.getElementById('modal-tax').textContent = order.tax;
                    document.getElementById('modal-total').textContent = order.total;
                    
                    const statusClass = order.status === 'Pending' ? 'status-pending' : 
                                      order.status === 'In Progress' ? 'status-in-progress' : 
                                      'status-completed';
                    
                    const statusElement = document.getElementById('modal-status');
                    statusElement.className = `px-3 py-1 inline-flex text-sm font-semibold rounded-full ${statusClass}`;
                    statusElement.textContent = order.status;
                    
                    // Fill order items
                    const modalItems = document.getElementById('modal-items');
                    modalItems.innerHTML = '';
                    
                    order.items.forEach(item => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td class="px-4 py-2 text-sm">${item.qty}</td>
                            <td class="px-4 py-2 text-sm">${item.desc}</td>
                            <td class="px-4 py-2 text-sm">${item.size}</td>
                            <td class="px-4 py-2 text-sm">${item.instructions}</td>
                            <td class="px-4 py-2 text-sm text-right">${item.price}</td>
                        `;
                        modalItems.appendChild(row);
                    });
                    
                    // Fill order history
                    const modalHistory = document.getElementById('modal-history');
                    modalHistory.innerHTML = '';
                    
                    order.history.forEach((entry, index) => {
                        const historyItem = document.createElement('div');
                        historyItem.className = index < order.history.length - 1 ? 'mb-3 pb-3 border-b border-gray-200' : '';
                        historyItem.innerHTML = `
                            <div class="text-sm text-gray-500">${entry.date}</div>
                            <div class="font-medium">${entry.action}</div>
                            <div class="text-sm">By: ${entry.by}</div>
                        `;
                        modalHistory.appendChild(historyItem);
                    });
                    
                    // Show modal
                    document.getElementById('order-details-modal').classList.remove('hidden');
                }
            }
            
            // Edit order
            function editOrder(controlNumber) {
                const order = orders.find(o => o.controlNumber === controlNumber);
                
                if (order) {
                    // Fill form with order details
                    document.getElementById('customer-name').value = order.customer;
                    document.getElementById('order-date').value = order.date;
                    document.getElementById('control-number').value = order.controlNumber;
                    document.getElementById('customer-phone').value = order.phone;
                    document.getElementById('customer-address').value = order.address;
                    
                    // Set term of service
                    const termSelect = document.getElementById('term-of-service');
                    for (let i = 0; i < termSelect.options.length; i++) {
                        if (termSelect.options[i].text === order.term) {
                            termSelect.selectedIndex = i;
                            break;
                        }
                    }
                    
                    // Set status
                    const statusSelect = document.getElementById('job-status');
                    for (let i = 0; i < statusSelect.options.length; i++) {
                        if (statusSelect.options[i].text === order.status) {
                            statusSelect.selectedIndex = i;
                            break;
                        }
                    }
                    
                    // Clear order items
                    const orderItems = document.getElementById('order-items');
                    orderItems.innerHTML = '';
                    
                    // Add order items
                    order.items.forEach(item => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td class="px-4 py-2">
                                <input type="number" class="windows-input w-16 item-qty" value="${item.qty}">
                            </td>
                            <td class="px-4 py-2">
                                <select class="windows-select w-full item-desc">
                                    <option ${item.desc === 'BANNERS' ? 'selected' : ''}>BANNERS</option>
                                    <option ${item.desc === 'SIGN' ? 'selected' : ''}>SIGN</option>
                                    <option ${item.desc === 'TSHIRT PRINTING' ? 'selected' : ''}>TSHIRT PRINTING</option>
                                    <option ${item.desc === 'VINYL STICKERS' ? 'selected' : ''}>VINYL STICKERS</option>
                                    <option ${item.desc === 'NUMBER PLATES' ? 'selected' : ''}>NUMBER PLATES</option>
                                    <option ${item.desc === 'NUMBER BOAT' ? 'selected' : ''}>NUMBER BOAT</option>
                                    <option ${item.desc === 'BILLBOARDS' ? 'selected' : ''}>BILLBOARDS</option>
                                    <option ${item.desc === 'LABELS' ? 'selected' : ''}>LABELS</option>
                                </select>
                            </td>
                            <td class="px-4 py-2">
                                <input type="text" class="windows-input w-full item-size" placeholder="Size" value="${item.size}">
                            </td>
                            <td class="px-4 py-2">
                                <input type="text" class="windows-input w-full item-instructions" placeholder="Instructions" value="${item.instructions}">
                            </td>
                            <td class="px-4 py-2">
                                <input type="number" class="windows-input w-24 item-price" placeholder="0.00" step="0.01" value="${item.price.replace('$', '')}">
                            </td>
                            <td class="px-4 py-2">
                                <button class="windows-button px-2 py-1 text-sm remove-item-btn">Remove</button>
                            </td>
                        `;
                        orderItems.appendChild(row);
                        
                        // Add event listeners
                        const removeBtn = row.querySelector('.remove-item-btn');
                        removeBtn.addEventListener('click', function() {
                            if (orderItems.children.length > 1) {
                                orderItems.removeChild(row);
                                calculateTotal();
                            }
                        });
                        
                        const priceInput = row.querySelector('.item-price');
                        priceInput.addEventListener('input', calculateTotal);
                        
                        const qtyInput = row.querySelector('.item-qty');
                        qtyInput.addEventListener('input', calculateTotal);
                    });
                    
                    // Calculate total
                    calculateTotal();
                    
                    // Show new order view
                    showView(newOrderView);
                    newOrderBtn.classList.add('tab-active');
                }
            }
            
            // Format date for display
            function formatDate(dateString) {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
            }
            
            // Order details modal
            const orderDetailsModal = document.getElementById('order-details-modal');
            const closeModalBtn = document.getElementById('close-modal-btn');
            
            // Close modal
            closeModalBtn.addEventListener('click', () => {
                orderDetailsModal.classList.add('hidden');
            });
            
            // Close modal when clicking outside
            orderDetailsModal.addEventListener('click', (e) => {
                if (e.target === orderDetailsModal) {
                    orderDetailsModal.classList.add('hidden');
                }
            });
            
            // Edit order button in modal
            document.getElementById('edit-order-btn').addEventListener('click', () => {
                if (currentOrder) {
                    orderDetailsModal.classList.add('hidden');
                    editOrder(currentOrder.controlNumber);
                }
            });
            
            // Print order button
            document.getElementById('print-order-btn').addEventListener('click', () => {
                window.print();
            });
            
            // Export PDF functions
            function exportToPDF(elementId, filename) {
                const element = document.getElementById(elementId);
                
                html2canvas(element).then(canvas => {
                    const imgData = canvas.toDataURL('image/png');
                    const pdf = new jsPDF('p', 'mm', 'a4');
                    const imgProps = pdf.getImageProperties(imgData);
                    const pdfWidth = pdf.internal.pageSize.getWidth();
                    const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
                    
                    pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
                    pdf.save(filename);
                    
                    showNotification('PDF exported successfully!');
                });
            }
            
            // Export buttons
            document.getElementById('export-dashboard-btn').addEventListener('click', () => {
                exportToPDF('dashboard-view', 'dashboard.pdf');
            });
            
            document.getElementById('export-new-order-btn').addEventListener('click', () => {
                exportToPDF('new-order-form', 'new-order.pdf');
            });
            
            document.getElementById('export-all-orders-btn').addEventListener('click', () => {
                exportToPDF('all-orders-container', 'all-orders.pdf');
            });
            
            document.getElementById('export-users-btn').addEventListener('click', () => {
                exportToPDF('users-container', 'users.pdf');
            });
            
            document.getElementById('export-order-btn').addEventListener('click', () => {
                exportToPDF('print-content', `order-${currentOrder.controlNumber.replace('#', '')}.pdf`);
            });
            
            // Update status button
            document.getElementById('update-status-btn').addEventListener('click', () => {
                if (currentOrder) {
                    document.getElementById('status-order-number').value = currentOrder.controlNumber;
                    document.getElementById('status-current').value = currentOrder.status;
                    
                    const statusSelect = document.getElementById('status-new');
                    for (let i = 0; i < statusSelect.options.length; i++) {
                        if (statusSelect.options[i].text === currentOrder.status) {
                            statusSelect.selectedIndex = i;
                            break;
                        }
                    }
                    
                    document.getElementById('status-modal').classList.remove('hidden');
                }
            });
            
            // Close status modal
            document.getElementById('close-status-modal-btn').addEventListener('click', () => {
                document.getElementById('status-modal').classList.add('hidden');
            });
            
            document.getElementById('cancel-status-btn').addEventListener('click', () => {
                document.getElementById('status-modal').classList.add('hidden');
            });
            
            // Save status
            document.getElementById('save-status-btn').addEventListener('click', () => {
                const newStatus = document.getElementById('status-new').value;
                const orderNumber = document.getElementById('status-order-number').value;
                
                const orderIndex = orders.findIndex(o => o.controlNumber === orderNumber);
                
                if (orderIndex !== -1) {
                    const oldStatus = orders[orderIndex].status;
                    
                    if (oldStatus !== newStatus) {
                        // Update status
                        orders[orderIndex].status = newStatus;
                        
                        // Add history entry
                        const now = new Date();
                        const formattedDateTime = `${now.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })} - ${now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true })}`;
                        
                        orders[orderIndex].history.unshift({
                            date: formattedDateTime,
                            action: `Order status changed to ${newStatus}`,
                            by: currentUser ? currentUser.name : "System"
                        });
                        
                        // Update UI
                        updateOrderCounts();
                        populateRecentOrders();
                        populateAllOrders();
                        
                        // Update modal
                        currentOrder = orders[orderIndex];
                        showOrderDetails(orderNumber);
                        
                        showNotification(`Order status updated to ${newStatus}`);
                    }
                }
                
                document.getElementById('status-modal').classList.add('hidden');
            });
            
            // Add user button
            document.getElementById('add-user-btn').addEventListener('click', () => {
                // Reset form
                document.getElementById('user-modal-title').textContent = 'Add New User';
                document.getElementById('user-username').value = '';
                document.getElementById('user-fullname').value = '';
                document.getElementById('user-password').value = '';
                document.getElementById('user-role').selectedIndex = 1; // Default to User role
                
                // Enable username field
                document.getElementById('user-username').disabled = false;
                
                // Show modal
                document.getElementById('user-modal').classList.remove('hidden');
            });
            
            // Close user modal
            document.getElementById('close-user-modal-btn').addEventListener('click', () => {
                document.getElementById('user-modal').classList.add('hidden');
            });
            
            document.getElementById('cancel-user-btn').addEventListener('click', () => {
                document.getElementById('user-modal').classList.add('hidden');
            });
            
            // Save user
            document.getElementById('save-user-btn').addEventListener('click', () => {
                const username = document.getElementById('user-username').value.trim();
                const fullname = document.getElementById('user-fullname').value.trim();
                const password = document.getElementById('user-password').value.trim();
                const role = document.getElementById('user-role').value;
                
                if (!username || !fullname || !password) {
                    showNotification('Please fill in all fields');
                    return;
                }
                
                const isEdit = document.getElementById('user-username').disabled;
                
                if (isEdit) {
                    // Update existing user
                    const userIndex = users.findIndex(u => u.username === username);
                    
                    if (userIndex !== -1) {
                        users[userIndex].name = fullname;
                        if (password) {
                            users[userIndex].password = password;
                        }
                        users[userIndex].role = role;
                        
                        showNotification('User updated successfully!');
                    }
                } else {
                    // Check if username already exists
                    if (users.some(u => u.username === username)) {
                        showNotification('Username already exists');
                        return;
                    }
                    
                    // Add new user
                    users.push({
                        username: username,
                        password: password,
                        name: fullname,
                        role: role,
                        lastLogin: null
                    });
                    
                    showNotification('User added successfully!');
                }
                
                // Update users table
                populateUsers();
                
                // Close modal
                document.getElementById('user-modal').classList.add('hidden');
            });
            
            // Edit user
            function editUser(username) {
                const user = users.find(u => u.username === username);
                
                if (user) {
                    document.getElementById('user-modal-title').textContent = 'Edit User';
                    document.getElementById('user-username').value = user.username;
                    document.getElementById('user-fullname').value = user.name;
                    document.getElementById('user-password').value = '';
                    
                    const roleSelect = document.getElementById('user-role');
                    for (let i = 0; i < roleSelect.options.length; i++) {
                        if (roleSelect.options[i].value === user.role) {
                            roleSelect.selectedIndex = i;
                            break;
                        }
                    }
                    
                    // Disable username field for editing
                    document.getElementById('user-username').disabled = true;
                    
                    // Show modal
                    document.getElementById('user-modal').classList.remove('hidden');
                }
            }
            
            // Delete user
            function deleteUser(username) {
                // Don't allow deleting the current user
                if (currentUser && currentUser.username === username) {
                    showNotification('Cannot delete your own account');
                    return;
                }
                
                // Confirm deletion
                if (confirm(`Are you sure you want to delete user "${username}"?`)) {
                    users = users.filter(u => u.username !== username);
                    populateUsers();
                    showNotification('User deleted successfully!');
                }
            }
            
            // Search orders
            document.getElementById('search-orders').addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const allOrdersTable = document.getElementById('all-orders-table');
                const rows = allOrdersTable.querySelectorAll('tr');
                
                rows.forEach(row => {
                    const controlNumber = row.cells[0].textContent.toLowerCase();
                    const customer = row.cells[1].textContent.toLowerCase();
                    const description = row.cells[3].textContent.toLowerCase();
                    
                    if (controlNumber.includes(searchTerm) || customer.includes(searchTerm) || description.includes(searchTerm)) {
                        row.style.display = '';
                    } else {
                        row.style.display = 'none';
                    }
                });
            });
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'965de3aa2192ca03',t:'MTc1MzYzNzY4NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
